{"version":3,"sources":["angular/routes.coffee"],"names":[],"mappings":"AAAA;EAAA,MAAA,CAAO,CACL,SADK,EAEL,KAFK,CAAP,EAGE,SAAC,OAAD,EAAS,GAAT;IACA;AAAA,QAAA;IACA,GAAG,CAAC,QAAJ,CACE,QADF,EACW;MACP,IAAA,EAAO,SAAA,GAAU,MAAM,CAAC,QAAQ,CAAC,IAD1B;MAEP,kBAAA,EAAqB,CAAA,SAAA,GAAU,MAAM,CAAC,QAAQ,CAAC,IAA1B,CAAA,GAAmC,MAAnC,GAA4C,YAF1D;MAGP,qBAAA,EAAwB,CAAA,SAAA,GAAU,MAAM,CAAC,QAAQ,CAAC,IAA1B,CAAA,GAAmC,MAAnC,GAA4C,YAH7D;MAIP,eAAA,EAAkB,CAAA,SAAA,GAAU,MAAM,CAAC,QAAQ,CAAC,IAA1B,CAAA,GAAmC,MAAnC,GAA4C,SAJvD;KADX;IAOA,GAAG,CAAC,GAAJ,CAAQ;MACN,YADM,EAEN,WAFM,EAGN,SAAC,UAAD,EAAY,SAAZ;QACE,UAAU,CAAC,GAAX,CAAe,oBAAf,EAAoC,SAAA;iBAClC,SAAS,CAAC,IAAV,CAAe,GAAf;QADkC,CAApC;eAEA,UAAU,CAAC,GAAX,CAAe,mBAAf,EAAmC,SAAC,KAAD,EAAO,OAAP,EAAe,QAAf,EAAwB,SAAxB,EAAkC,UAAlC,EAA6C,KAA7C;UACjC,OAAO,CAAC,GAAR,CAAY,IAAZ;UACA,OAAO,CAAC,GAAR,CAAY,KAAZ;UACA,IAAG,KAAK,CAAC,MAAN,KAAgB,GAAnB;mBACE,MAAM,CAAC,YAAP,CACE,OADF,EAEE;cAAA,SAAA,EAAY,SAAS,CAAC,GAAV,CAAA,CAAZ;aAFF,EADF;;QAHiC,CAAnC;MAHF,CAHM;KAAR;IAeA,MAAA,GAAS,GAAG,CAAC,MAAJ,CAAW;MAClB,gBADkB,EAElB,mBAFkB,EAGlB,oBAHkB,EAIlB,QAJkB,EAKlB,SAAC,cAAD,EAAgB,iBAAhB,EAAkC,kBAAlC,EAAqD,MAArD;QACE,cAAc,CAAC,KAAf,CAAqB,MAArB,EAA4B;UAC1B,GAAA,EAAM,GADoB;UAE1B,WAAA,EAAc,MAAM,CAAC,qBAAP,GAA+B,aAFnB;UAG1B,UAAA,EAAa,WAHa;SAA5B,CAKA,CAAC,KALD,CAKO,cALP,EAKsB;UACpB,GAAA,EAAM,gBADc;UAEpB,WAAA,EAAiB,MAAM,CAAC,qBAAR,GAA8B,8BAF1B;UAGpB,UAAA,EAAa,kBAHO;SALtB,CAUA,CAAC,KAVD,CAUO,UAVP,EAUkB;UAChB,GAAA,EAAM,0BADU;UAEhB,WAAA,EAAiB,MAAM,CAAC,qBAAR,GAA8B,yBAF9B;UAGhB,UAAA,EAAa,cAHG;SAVlB,CAeA,CAAC,KAfD,CAeO,SAfP,EAeiB;UACf,GAAA,EAAM,mCADS;UAEf,WAAA,EAAiB,MAAM,CAAC,qBAAR,GAA8B,wBAF/B;UAGf,UAAA,EAAa,aAHE;SAfjB;QAoBA,iBAAiB,CAAC,SAAlB,CAA4B;UAC1B,OAAA,EAAU,IADgB;UAE1B,WAAA,EAAc,KAFY;SAA5B,CAGE,CAAC,UAHH,CAGc,GAHd;eAIA,kBAAkB,CAAC,SAAnB,CAA6B,GAA7B;MAzBF,CALkB;KAAX;;AAgCT;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;WAmEA;EA3HA,CAHF;AAAA","file":"angular/routes.js","sourceRoot":"/source/","sourcesContent":["define [\n  \"angular\"\n  \"app\"\n],(angular,app) ->\n  \"use strict\"\n  app.constant(\n    \"config\",{\n      path : \"http://#{window.location.host}\"\n      adminTemplatesPath : \"http://#{window.location.host}\" + '/app' + '/templates'\n      frontendTemplatesPath : \"http://#{window.location.host}\" + '/app' + '/templates'\n      frontendImgPath : \"http://#{window.location.host}\" + '/app' + '/images'\n    })\n  app.run([\n    \"$rootScope\"\n    \"$location\"\n    ($rootScope,$location)->\n      $rootScope.$on 'auth:login-success',->\n        $location.path('/')\n      $rootScope.$on '$stateChangeError',(event,toState,toParams,fromState,fromParams,error) ->\n        console.log('dd')\n        console.log(error);\n        if(error.status == 401)\n          $state.transitionTo(\n            \"login\",\n            returnUrl : $location.url()\n          )\n  ])\n  routes = app.config([\n    '$stateProvider',\n    '$locationProvider',\n    '$urlRouterProvider',\n    'config'\n    ($stateProvider,$locationProvider,$urlRouterProvider,config)->\n      $stateProvider.state('home',{\n        url : \"/\",\n        templateUrl : config.frontendTemplatesPath + \"/index.html\",\n        controller : \"indexCtrl\"\n      })\n      .state('lineCategory',{\n        url : \"/:lineCategory\",\n        templateUrl : \"#{config.frontendTemplatesPath}/category/list-category.html\"\n        controller : \"lineCategoryCtrl\"\n      })\n      .state('category',{\n        url : \"/:lineCategory/:category\",\n        templateUrl : \"#{config.frontendTemplatesPath}/category/category.html\"\n        controller : \"categoryCtrl\"\n      })\n      .state('article',{\n        url : \"/:lineCategory/:category/:article\",\n        templateUrl : \"#{config.frontendTemplatesPath}/category/article.html\"\n        controller : \"ArticleCtrl\"\n      });\n      $locationProvider.html5Mode({\n        enabled : true,\n        requireBase : false\n      }).hashPrefix('!');\n      $urlRouterProvider.otherwise('/');\n  ]);\n  ###routes = app.config([\n\"$routeProvider\"\n\"$locationProvider\"\n\"config\"\n($routeProvider,$locationProvider,config) ->\n  $routeProvider\n  .when \"/\",\n    templateUrl : \"#{config.frontendTemplatesPath}/index.html\"\n    controller : \"indexCtrl\"\n    redirectTo : (current,path,search) ->\n      if search\n        if search.goto\n          \"/\" + search.goto\n        else\n          \"/\"\n  .when \"/sign_in\",\n    templateUrl : \"#{config.frontendTemplatesPath}/user_sessions/new.html\"\n    controller : \"UserSessionsCtrl\"\n  .when \"/sign_up\",\n    templateUrl : \"#{config.frontendTemplatesPath}/user_registrations/new.html\"\n    controller : \"UserRegistrationsCtrl\"\n  .when \"/groups\",\n    templateUrl : \"#{config.frontendTemplatesPath}/groups.html\"\n    controller : \"GroupsCtrl\"\n    resolve :\n      auth : [\n        \"$auth\"\n        \"$location\"\n        ($auth,$location)->\n          $auth.validateUser()\n          #              console.log($auth.authenticate('asdalexey@yandex.ru'))\n          #isLogged == 0 - Пользователь залогинен и находился на этой странице\n          #isLogged == 1 - Пользователь залогинен\n          #isLogged == 2 - Пользователь не залогинен\n          isLogged = $auth.validateUser().$$state.status\n          if isLogged is 2\n            $location.path('/groups')\n      ]\n  .when \"/:lineCategory\",\n    templateUrl : \"#{config.frontendTemplatesPath}/category/list-category.html\"\n    controller : \"lineCategoryCtrl\"\n    resolve : {\n      \"load\" : ($rootScope,$timeout)->\n#            $timeout (->\n#              routeChange = (event,newUrl)->\n#                event.preventDefault()\n#                console.log('start')\n#                $('.preloader').removeClass('hideAnimation').removeClass('hidden')\n#                onRouteChangeOff()\n#                $timeout (->\n#                  console.log(newUrl)\n#                  $location.path(newUrl)\n#                  $rootScope.routLoad = true\n#                ),800\n#              onRouteChangeOff = $rootScope.$on('$locationChangeStart',routeChange)\n#            )\n    }\n  .when \"/:lineCategory/:category\",\n    templateUrl : \"#{config.frontendTemplatesPath}/category/category.html\"\n    controller : \"categoryCtrl\"\n  .when \"/:lineCategory/:category/:article\",\n    templateUrl : \"#{config.frontendTemplatesPath}/category/article.html\"\n    controller : \"articleCtrl\"\n  .otherwise redirectTo : \"/\"\n  $locationProvider.hashPrefix('!')\n  $locationProvider.html5Mode(true)\n])###\n  routes\n"]}